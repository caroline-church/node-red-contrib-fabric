<!--
Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->
<script type="text/x-red" data-template-name="fabric-out">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="node-red:common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]node-red:common.label.name">
    </div>

    <div class="form-row">
        <label for="node-input-connection"><i class="fa"></i>Connection</label>
        <input type="select" id="node-input-connection" placeholder="Connection" />
    </div>

    <div class="form-row">
        <label for="node-input-channelName"><i class="fa"></i>Channel Name</label>
        <input type="text" id="node-input-channelName" placeholder="" />
    </div>

    <div class="form-row">
        <label for="node-input-contractName"><i class="fa"></i>Contract Name</label>
        <input type="text" id="node-input-contractName" placeholder="" />
    </div>

    <div class="form-row">
        <label for="node-input-actionType"><i class="fa"></i>Action Type</label>
        <select id="node-input-actionType">
            <option value="submit">Submit Transaction</option>
            <option value="evaluate">Evaluate Transaction</option>
        </select>
    </div>
</script>
<script type="text/x-red" data-template-name="fabric-mid">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="node-red:common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]node-red:common.label.name">
    </div>

    <div class="form-row">
        <label for="node-input-connection"><i class="fa"></i>Connection</label>
        <input type="select" id="node-input-connection" placeholder="Connection" />
    </div>

    <div class="form-row">
        <label for="node-input-channelName"><i class="fa"></i>Channel Name</label>
        <input type="text" id="node-input-channelName" placeholder="" />
    </div>

    <div class="form-row">
        <label for="node-input-contractName"><i class="fa"></i>Contract Name</label>
        <input type="text" id="node-input-contractName" placeholder="" />
    </div>

    <div class="form-row">
        <label for="node-input-actionType"><i class="fa"></i>Action Type</label>
        <select id="node-input-actionType">
            <option value="submit">Submit Transaction</option>
            <option value="evaluate">Evaluate Transaction</option>
            <option value="event">Listen Event</option>
            <option value="block">Query Block</option>
            <option value="transaction">Query Transaction</option>
        </select>
    </div>

</script>
<script type="text/x-red" data-template-name="fabric-in">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="node-red:common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]node-red:common.label.name">
    </div>
    <div class="form-row">
        <label for="node-input-connection"><i class="fa"></i>Connection</label>
        <input type="select" id="node-input-connection" placeholder="Connection" />
    </div>
    <div class="form-row">
        <label for="node-input-channelName"><i class="fa"></i>Channel Name</label>
        <input type="text" id="node-input-channelName" placeholder="" />
    </div>
    <div class="form-row">
        <label for="node-input-contractName"><i class="fa"></i>Contract Name</label>
        <input type="text" id="node-input-contractName" placeholder="" />
    </div>
    <div class="form-row">
        <label for="node-input-eventName"><i class="fa"></i>Event Name</label>
        <input type="text" id="node-input-eventName" placeholder=".*" />
    </div>
    <div class="form-row">
        <label for="node-input-startBlock"><i class="fa"></i>Start Block</label>
        <input type="text" id="node-input-startBlock" placeholder="" />
    </div>
    <div class="form-row">
        <label for="node-input-endBlock"><i class="fa"></i>End Block</label>
        <input type="text" id="node-input-endBlock" placeholder="" />
    </div>
    <div class="form-row">
        <label for="node-input-timeout"><i class="fa"></i>Timeout</label>
        <input type="text" id="node-input-timeout" placeholder="" />
    </div>

</script>
<script type="text/x-red" data-help-name="fabric-out">
    <p>Hyperledger Fabric output node. Submit or evaluate transactions</p>
    <p>The name of the transaction should be set like <code>msg.payload.transactionName</code></p>
    <p>The arguments for the transaction should be set like <code>msg.payload.args</code>. The arguments should be an array of strings</p>
    <p>For example <code>{"transactionName: "myTransaction", "args": ["arg1", "arg2"]}</code></p>
</script>
<script type="text/javascript">
    RED.nodes.registerType('fabric-out', {
        category: 'Hyperledger',
        color: '#E6E0F8',
        paletteLabel: 'Hyperledger Fabric - Out',
        defaults: {
            name: {
                value: ''
            },
            connection: {
                value: '',
                type: 'fabric-config'
            },
            channelName: {
                value: '',
                required: true
            },
            contractName: {
                value: '',
                required: true
            },
            actionType: {
                value: 'submit'
            }
        },
        inputs: 1,
        outputs: 0,
        icon: 'icon.png',
        align: 'right',
        label: function() {
            return this.name || 'Hyperledger Fabric - Out';
        }
    });
</script>

<script type="text/x-red" data-help-name="fabric-mid">
    <p>Hyperledger Fabric mid node. Submit or evaluate transactions, listen for events, query a block or query a transaction</p>


    <ul>
        <li>Submit/evaluate
            <ul>
                <li>the arguments for the transaction should be set like <code>msg.payload.transactionArgs</code>.</li>
                <li>The arguments should be an array of strings</li>
                <li>The name of the transaction should be set like <code>msg.payload.transactionName</code></li>
                <li>The type of action the node should perform (<code>submit</code> or <code>evaluate</code>) should be set like <code>msg.payload.actionType</code>. The value set in the node will be overwritten by the value in <code>msg.payload</code></li>
                <li>Example: <code>{"transactionArgs": ["ARG0","ARG1","etc."],"transactionName": "myTxName","actionType": "submit","contractName": "myContractName"
                }</code> </li>
            </ul>
        </li>
        <li>Event
            <ul>
                <li>The timeout allows you to change the way the results are sent back to you. It is <code>"true"</code> by default. When <code>"true"</code>, it returns the events all at once in an array. When it is <code>"false"</code>, it returns the events
                    one by one in <code>msg.payload</code> and will not stop to listen</li>
                <li><code>"startBlock"</code> and <code>"endBlock"</code> can be specified. When not, starts from 0 and never stops.</li>
                <li><code>"eventName"</code> is the name of the event to match. Keep in mind that it accepts regular expressions.</li>
                <li><code>"contractName"</code> is the name of the contract (chaincode) to listen events on.</li>
                <li><code>"orgName"</code> is the name of the organization of the peer you connect to</li>
                <li><code>"peerName"</code> is the name of the peer you connect to</li>
                <li>The type of action the node should perform (<code>event</code>) should be set like <code>msg.payload.actionType</code>. The value set in the node will be overwritten by the value in <code>msg.payload</code></li>
                <li>Example: <code>{"startBlock": "myStartBlock","endBlock": "myEndBlock","timeout": "myTimeout","eventName": "myEventName","contractName": "myContractName","actionType": "event","orgName": "myOrgName","peerName": "myPeerName"}</code></li>
            </ul>
        </li>
    </ul>
    <li>Block
        <ul>
            <li>The type of action the node should perform (<code>block</code>) should be set like <code>msg.payload.actionType</code>. The value set in the node will be overwritten by the value in <code>msg.payload</code></li>
            <li>The number of the block to use should be set like <code>msg.payload.blockNumber</code>.
                <li>Example: <code>{"actionType": "block","orgName": "myOrgName","peerName": "myPeerName","blockNumber": myBlockNumber}</code> </li>
        </ul>
        </li>
        <li>transaction
            <ul>
                <li>The type of action the node should perform (<code>transaction</code>) should be set like <code>msg.payload.actionType</code>. The value set in the node will be overwritten by the value in <code>msg.payload</code></li>
                <li>The id of the transaction to query should be set like <code>msg.payload.transactionId</code> </li>
                <li>Example: <code>{"actionType": "transaction","orgName": "myOrgName","peerName": "myPeerName","transactionId": "myTxId"}</code> </li>
            </ul>
        </li>
        <p>Data returned from a transaction will be in <code>msg.payload</></p>
  <p>The <code>payload</code> will be a buffer and you will need to deserialize the data downstream</p>
        <p>For example <code>msg.payload.toString()</code>

</script>
<script type="text/javascript">
    RED.nodes.registerType('fabric-mid', {
        category: 'Hyperledger',
        color: '#E6E0F8',
        paletteLabel: 'Hyperledger Fabric - Mid',
        defaults: {
            name: {
                value: ''
            },
            connection: {
                value: '',
                type: 'fabric-config'
            },
            channelName: {
                value: '',
                required: false
            },
            contractName: {
                value: '',
                required: false
            },
            actionType: {
                value: 'submit'
            }
        },
        inputs: 1,
        outputs: 1,
        icon: 'icon.png',
        label: function() {
            return this.name || 'Hyperledger Fabric - Mid';
        },
    });
</script>
<script type="text/x-red" data-help-name="fabric-in">
    <p>Hyperledger Fabric input node. Subscribe to events emitted by a blockchain</p>.
    <p>Will create a message with the structure <code>{"eventName" : "myEvent", "payload": "myPayload"}</code></p>
    <p>The <code>payload</code> will be a buffer and you will need to deserialize the data downstream</p>
    <p>For example <code>msg.payload.toString()</code>
</script>
<script type="text/javascript">
    RED.nodes.registerType('fabric-in', {
        category: 'Hyperledger',
        color: "#E6E0F8",
        paletteLabel: "Hyperledger Fabric",
        defaults: {
            name: {
                value: ""
            },
            connection: {
                value: '',
                type: 'fabric-config'
            },
            channelName: {
                value: '',
                required: true
            },
            contractName: {
                value: '',
                required: true
            },
            eventName: {
                value: '.*',
                required: false
            },
            startBlock: {
                value: '',
                required: false
            },
            endBlock: {
                value: '',
                required: false
            },
            timeout: {
                value: 'true',
                required: false
            },
        },
        inputs: 0,
        outputs: 1,
        icon: "icon.png",
        align: "left",
        label: function() {
            return this.name || "Hyperledger Fabric";
        }
    });
</script>